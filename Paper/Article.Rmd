---
title: "Just Take the Bus: Analysis of Toronto Bike Theft from 2022-2024"
subtitle: idk 
author:
- Rayan Awad Alim
- Samreen Gill
date: "November 4th 2024"
output: pdf_document
date-format: long
abstract: "This analysis examines Bike theft data obtained from the Tronrot Police Data Portal."

format: pdf
thanks: 'Code and data are available at: https://github.com/RayanAlim/US_Census_Education_Data_Analysis/'
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(dplyr)
library(here)
library(knitr)
```


```{r}
bike_thefts_csv <- read_csv(here("Data", "Bike_thefts_raw.csv"))
head(bike_thefts_csv)
```

```{r}
library(lubridate)
bike_thefts_csv$OCC_DATE <- ymd_hms(bike_thefts_csv$OCC_DATE)
bike_thefts_csv$REPORT_DATE <- ymd_hms(bike_thefts_csv$REPORT_DATE)
```


```{r}
library(ggplot2)
library(dplyr)

bike_thefts_csv %>%
  mutate(Month = floor_date(OCC_DATE, "month")) %>%
  group_by(Month) %>%
  summarize(Count = n()) %>%
  ggplot(aes(x = Month, y = Count)) +
  geom_line(color = "blue") +
  labs(title = "Monthly Bike Theft Trends in Toronto",
       x = "Month", y = "Number of Thefts") +
  theme_minimal()

```




```{r}
ggplot(bike_thefts_csv, aes(x = BIKE_COST)) +
  geom_histogram(binwidth = 100, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Stolen Bike Costs",
       x = "Cost of Bike (CAD)", y = "Frequency") +
  theme_minimal()

```


```{r}
library(leaflet)

leaflet(data = bike_thefts_csv) %>%
  addTiles() %>%
  addCircleMarkers(
    ~LONG_WGS84, ~LAT_WGS84,
    color = "red", radius = 3,
    popup = ~paste("Cost:", BIKE_COST, "<br>",
                   "Date:", OCC_DATE)
  ) %>%
  addLegend("topright", colors = "red", labels = "Bike Theft", title = "Theft Locations")

```

##

```{r}
bike_thefts_csv %>%
  count(NEIGHBOURHOOD_158) %>%
  ggplot(aes(x = reorder(NEIGHBOURHOOD_158, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +
  labs(title = "Bike Thefts by Neighborhood",
       x = "Neighborhood", y = "Number of Thefts") +
  theme_minimal()
# NOTE TO ME: cut to TOP 10
```

```{r}
bike_thefts_csv %>%
  count(OCC_DOW) %>%
  ggplot(aes(x = OCC_DOW, y = n, fill = OCC_DOW)) +
  geom_bar(stat = "identity") +
  labs(title = "Bike Thefts by Day of the Week",
       x = "Day of the Week", y = "Number of Thefts") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set3")
```


```{r}
```


```{r}
```

# Data

We used the statistical programming language R [@citeR], dpylr [@dpylr], here [@here], and tidyverse [@rohan] to assist with cleaning and analyzing the data. We rendered our table using knitr [@citeknitr]. 

The data we used is taken from IPUMS [@ipumsusa].




Possible viz:
- Neighbourhoods 
- Months of the year 
- Day of the week 
- Value 
-

Possible Extensions:
- vs car thefts 

